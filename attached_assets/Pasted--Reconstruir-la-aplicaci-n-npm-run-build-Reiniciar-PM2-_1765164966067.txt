# Reconstruir la aplicación
npm run build

# Reiniciar PM2
pm2 restart sheltiescrm && pm2 logs sheltiescrm --lines 10

> rest-express@1.0.0 build
> vite build && esbuild server/index.ts --platform=node --packages=external --bundle --format=esm --outdir=dist

vite v5.4.19 building for production...
transforming (3) src/main.tsxBrowserslist: browsers data (caniuse-lite) is 14 months old. Please run:
  npx update-browserslist-db@latest
  Why you should do it regularly: https://github.com/browserslist/update-db#readme
✓ 2960 modules transformed.
../dist/public/index.html                                             2.20 kB │ gzip:   0.86 kB
../dist/public/assets/logo-shelties-2_1756234700564-BEzgD2e5.png     18.36 kB
../dist/public/assets/logo shelties_1756234743860-b3IsEVri.png       18.45 kB
../dist/public/assets/index-k-Iit28r.css                             81.18 kB │ gzip:  13.97 kB
../dist/public/assets/index-BbLyZDiP.js                           1,258.31 kB │ gzip: 334.39 kB

(!) Some chunks are larger than 500 kB after minification. Consider:
- Using dynamic import() to code-split the application
- Use build.rollupOptions.output.manualChunks to improve chunking: https://rollupjs.org/configuration-options/#output-manualchunks
- Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.
✓ built in 6.65s
✘ [ERROR] The symbol "useSecureCookies" has already been declared

    server/auth.ts:36:9:
      36 │    const useSecureCookies = isProduction && process.env.USE_HTTPS ...
         ╵          ~~~~~~~~~~~~~~~~

  The symbol "useSecureCookies" was originally declared here:

    server/auth.ts:34:8:
      34 │   const useSecureCookies = isProduction && process.env.USE_HTTPS =...
         ╵         ~~~~~~~~~~~~~~~~

1 error
Use --update-env to update environment variables
[PM2] Applying action restartProcessId on app [sheltiescrm](ids: [ 0 ])
[PM2] [sheltiescrm](0) ✓
┌────┬────────────────────┬──────────┬──────┬───────────┬──────────┬──────────┐
│ id │ name               │ mode     │ ↺    │ status    │ cpu      │ memory   │
├────┼────────────────────┼──────────┼──────┼───────────┼──────────┼──────────┤
│ 0  │ sheltiescrm        │ fork     │ 5    │ online    │ 0%       │ 17.6mb   │
└────┴────────────────────┴──────────┴──────┴───────────┴──────────┴──────────┘
[TAILING] Tailing last 10 lines for [sheltiescrm] process (change the value with --lines option)
/root/.pm2/logs/sheltiescrm-error.log last 10 lines:
0|shelties |   },
0|shelties |   [Symbol(kType)]: 'error',
0|shelties |   [Symbol(kError)]: AggregateError [ECONNREFUSED]: 
0|shelties |       at internalConnectMultiple (node:net:1122:18)
0|shelties |       at afterConnectMultiple (node:net:1689:7) {
0|shelties |     code: 'ECONNREFUSED',
0|shelties |     [errors]: [ [Error], [Error] ]
0|shelties |   },
0|shelties |   [Symbol(kMessage)]: ''
0|shelties | }

/root/.pm2/logs/sheltiescrm-out.log last 10 lines:
0|shelties | 3:30:07 AM [express] GET /api/auth/user 401 in 1ms :: {"message":"Unauthorized"}
0|shelties | 3:30:07 AM [express] GET /api/auth/admin-exists 500 in 5ms :: {"message":"Error checking admin statu…
0|shelties | 3:30:39 AM [express] POST /api/auth/login 401 in 4ms :: {"message":"Email o contraseña incorrectos"}
0|shelties | 3:30:40 AM [express] POST /api/auth/login 401 in 4ms :: {"message":"Email o contraseña incorrectos"}
0|shelties | 3:30:47 AM [express] POST /api/auth/login 401 in 4ms :: {"message":"Email o contraseña incorrectos"}
0|shelties | 
0|shelties | > rest-express@1.0.0 start
0|shelties | > NODE_ENV=production node dist/index.js
0|shelties | 
0|shelties | 3:33:09 AM [express] serving on port 5000

0|sheltiescrm  | > rest-express@1.0.0 start
0|sheltiescrm  | > NODE_ENV=production node dist/index.js
0|sheltiescrm  | Error creating default services: ErrorEvent {
0|sheltiescrm  |   [Symbol(kTarget)]: WebSocket {
0|sheltiescrm  |     _events: [Object: null prototype] {
0|sheltiescrm  |       error: [Function],
0|sheltiescrm  |       message: [Function],
0|sheltiescrm  |       close: [Function],
0|sheltiescrm  |       open: [Function]
0|sheltiescrm  |     },
0|sheltiescrm  |     _eventsCount: 4,
0|sheltiescrm  |     _maxListeners: undefined,
0|sheltiescrm  |     _binaryType: 'arraybuffer',
0|sheltiescrm  |     _closeCode: 1006,
0|sheltiescrm  |     _closeFrameReceived: false,
0|sheltiescrm  |     _closeFrameSent: false,
0|sheltiescrm  |     _closeMessage: <Buffer >,
0|sheltiescrm  |     _closeTimer: null,
0|sheltiescrm  |     _errorEmitted: true,
0|sheltiescrm  |     _extensions: {},
0|sheltiescrm  |     _paused: false,
0|sheltiescrm  |     _protocol: '',
0|sheltiescrm  |     _readyState: 3,
0|sheltiescrm  |     _receiver: null,
0|sheltiescrm  |     _sender: null,
0|sheltiescrm  |     _socket: null,
0|sheltiescrm  |     _bufferedAmount: 0,
0|sheltiescrm  |     _isServer: false,
0|sheltiescrm  |     _redirects: 0,
0|sheltiescrm  |     _autoPong: true,
0|sheltiescrm  |     _url: 'wss://localhost/v2',
0|sheltiescrm  |     _req: null,
0|sheltiescrm  |     [Symbol(shapeMode)]: false,
0|sheltiescrm  |     [Symbol(kCapture)]: false
0|sheltiescrm  |   },
0|sheltiescrm  |   [Symbol(kType)]: 'error',
0|sheltiescrm  |   [Symbol(kError)]: AggregateError [ECONNREFUSED]: 
0|sheltiescrm  |       at internalConnectMultiple (node:net:1122:18)
0|sheltiescrm  |       at afterConnectMultiple (node:net:1689:7) {
0|sheltiescrm  |     code: 'ECONNREFUSED',
0|sheltiescrm  |     [errors]: [ [Error], [Error] ]
0|sheltiescrm  |   },
0|sheltiescrm  |   [Symbol(kMessage)]: ''
0|sheltiescrm  | }
0|sheltiescrm  | 3:35:17 AM [express] serving on port 5000